from meshpy.tet import MeshInfo, build

mesh_info = MeshInfo()
mesh_info.set_points([
    (0,0,0), (2,0,0), (2,2,0), (0,2,0),
    (0,0,6), (2,0,6), (2,2,6), (0,2,6),
    (0,0,12), (2,0,12), (2,2,12), (0,2,12),
    (0,0,18), (2,0,18), (2,2,18), (0,2,18),
    (4,0,0), (6,0,0), (6,2,0), (4,2,0),
    (4,0,6), (6,0,6), (6,2,6), (4,2,6),
    (4,0,12), (6,0,12), (6,2,12), (4,2,12),
    (4,0,18), (6,0,18), (6,2,18), (4,2,18),
    (0,4,0), (2,4,0), (2,6,0), (0,6,0),
    (0,4,6), (2,4,6), (2,6,6), (0,6,6),
    (0,4,12), (2,4,12), (2,6,12), (0,6,12),
    (0,4,18), (2,4,18), (2,6,18), (0,6,18),
    (4,4,0), (6,4,0), (6,6,0), (4,6,0),
    (4,4,6), (6,4,6), (6,6,6), (4,6,6),
    (4,4,12), (6,4,12), (6,6,12), (4,6,12),
    (4,4,18), (6,4,18), (6,6,18), (4,6,18),
    ])
mesh_info.set_facets([
    [0,1,2,3],
    [4,5,6,7],
    [0,4,5,1],
    [1,5,6,2],
    [2,6,7,3],
    [3,7,4,0],
    [8,9,10,11],
    [4,8,9,5],
    [5,9,10,6],
    [6,10,11,7],
    [7,11,8,4],
    [12,13,14,15],
    [8,12,13,9],
    [9,13,14,10],
    [10,14,15,11],
    [11,15,12,8],
    [1,2,3+16,0+16],
    [2,3+16,7+16,2+4],
    [0+16,1,1+4,4+16],
    [1+4,2+4,7+16,4+16],
    [2+4,7+16,11+16,2+8],
    [4+16,1+4,1+8,8+16],
    [1+8,2+8,11+16,8+16],
    [2+8,11+16,15+16,2+12],
    [8+16,1+8,1+12,12+16],
    [1+12,2+12,15+16,12+16],
    [0+16,1+16,2+16,3+16],
    [4+16,5+16,6+16,7+16],
    [0+16,4+16,5+16,1+16],
    [1+16,5+16,6+16,2+16],
    [2+16,6+16,7+16,3+16],
    [3+16,7+16,4+16,0+16],
    [8+16,9+16,10+16,11+16],
    [4+16,8+16,9+16,5+16],
    [5+16,9+16,10+16,6+16],
    [6+16,10+16,11+16,7+16],
    [7+16,11+16,8+16,4+16],
    [12+16,13+16,14+16,15+16],
    [8+16,12+16,13+16,9+16],
    [9+16,13+16,14+16,10+16],
    [10+16,14+16,15+16,11+16],
    [11+16,15+16,12+16,8+16],
    [0+32,1+32,2+32,3+32],
    [4+32,5+32,6+32,7+32],
    [0+32,4+32,5+32,1+32],
    [1+32,5+32,6+32,2+32],
    [2+32,6+32,7+32,3+32],
    [3+32,7+32,4+32,0+32],
    [8+32,9+32,10+32,11+32],
    [4+32,8+32,9+32,5+32],
    [5+32,9+32,10+32,6+32],
    [6+32,10+32,11+32,7+32],
    [7+32,11+32,8+32,4+32],
    [12+32,13+32,14+32,15+32],
    [8+32,12+32,13+32,9+32],
    [9+32,13+32,14+32,10+32],
    [10+32,14+32,15+32,11+32],
    [11+32,15+32,12+32,8+32],
    [1+32,2+32,3+16+32,0+16+32],
    [2+32,3+16+32,7+16+32,2+4+32],
    [0+16+32,1+32,1+4+32,4+16+32],
    [1+4+32,2+4+32,7+16+32,4+16+32],
    [2+4+32,7+16+32,11+16+32,2+8+32],
    [4+16+32,1+4+32,1+8+32,8+16+32],
    [1+8+32,2+8+32,11+16+32,8+16+32],
    [2+8+32,11+16+32,15+16+32,2+12+32],
    [8+16+32,1+8+32,1+12+32,12+16+32],
    [1+12+32,2+12+32,15+16+32,12+16+32],
    [0+16+32,1+16+32,2+16+32,3+16+32],
    [4+16+32,5+16+32,6+16+32,7+16+32],
    [0+16+32,4+16+32,5+16+32,1+16+32],
    [1+16+32,5+16+32,6+16+32,2+16+32],
    [2+16+32,6+16+32,7+16+32,3+16+32],
    [3+16+32,7+16+32,4+16+32,0+16+32],
    [8+16+32,9+16+32,10+16+32,11+16+32],
    [4+16+32,8+16+32,9+16+32,5+16+32],
    [5+16+32,9+16+32,10+16+32,6+16+32],
    [6+16+32,10+16+32,11+16+32,7+16+32],
    [7+16+32,11+16+32,8+16+32,4+16+32],
    [12+16+32,13+16+32,14+16+32,15+16+32],
    [8+16+32,12+16+32,13+16+32,9+16+32],
    [9+16+32,13+16+32,14+16+32,10+16+32],
    [10+16+32,14+16+32,15+16+32,11+16+32],
    [11+16+32,15+16+32,12+16+32,8+16+32],
    [2,3,0+32,1+32],
    [6,7,4+32,5+32],
    [3,7,4+32,0+32],
    [2,6,5+32,1+32],
    [2+8,3+8,0+32+8,1+32+8],
    [6+8,7+8,4+32+8,5+32+8],
    [3+8,7+8,4+32+8,0+32+8],
    [2+8,6+8,5+32+8,1+32+8],
    [2+16,3+16,0+32+16,1+32+16],
    [6+16,7+16,4+32+16,5+32+16],
    [3+16,7+16,4+32+16,0+32+16],
    [2+16,6+16,5+32+16,1+32+16],
    [2+8+16,3+8+16,0+32+8+16,1+32+16+8],
    [6+16+8,7+16+8,4+32+16+8,5+32+16+8],
    [3+16+8,7+16+8,4+32+16+8,0+32+16+8],
    [2+16+8,6+16+8,5+32+16+8,1+32+16+8],
    [2,1+32,0+32+16,3+16],
    [2+8,1+32+8,0+32+16+8,3+16+8],
    [6,5+32,4+32+16,7+16],
    [6+8,5+32+8,4+32+16+8,7+16+8],
    [3+8,0+32+8,4+32,7],
    [3+16+8,0+32+16+8,4+32+16,7+16],
    [2+8,1+32+8,5+32,6],
    [2+8+16,1+32+8+16,5+32+16,6+16],
    ])
mesh = build(mesh_info)
print "Mesh Points:"
for i, p in enumerate(mesh.points):
    print i, p
print "Point numbers in tetrahedra:"
for i, t in enumerate(mesh.elements):
    print i, t
mesh.write_vtk("test.vtk")
