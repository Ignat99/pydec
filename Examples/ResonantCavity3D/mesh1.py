from meshpy.tet import MeshInfo, build

mesh_info = MeshInfo()
mesh_info.set_points([
    (0,0,0), (2,0,0), (2,2,0), (0,2,0),
    (0,0,6), (2,0,6), (2,2,6), (0,2,6),
    (0,0,12), (2,0,12), (2,2,12), (0,2,12),
    (0,0,18), (2,0,18), (2,2,18), (0,2,18),
    (4,0,0), (6,0,0), (6,2,0), (4,2,0),
    (4,0,6), (6,0,6), (6,2,6), (4,2,6),
    (4,0,12), (6,0,12), (6,2,12), (4,2,12),
    (4,0,18), (6,0,18), (6,2,18), (4,2,18),
    ])
mesh_info.set_facets([
    [0,1,2,3],
    [4,5,6,7],
    [0,4,5,1],
    [1,5,6,2],
    [2,6,7,3],
    [3,7,4,0],
    [8,9,10,11],
    [4,8,9,5],
    [5,9,10,6],
    [6,10,11,7],
    [7,11,8,4],
    [12,13,14,15],
    [8,12,13,9],
    [9,13,14,10],
    [10,14,15,11],
    [11,15,12,8],
    [1,2,3+16,0+16],
    [2,3+16,7+16,2+4],
    [0+16,1,1+4,4+16],
    [1+4,2+4,7+16,4+16],
    [2+4,7+16,11+16,2+8],
    [4+16,1+4,1+8,8+16],
    [1+8,2+8,11+16,8+16],
    [2+8,11+16,15+16,2+12],
    [8+16,1+8,1+12,12+16],
    [1+12,2+12,15+16,12+16],
    [0+16,1+16,2+16,3+16],
    [4+16,5+16,6+16,7+16],
    [0+16,4+16,5+16,1+16],
    [1+16,5+16,6+16,2+16],
    [2+16,6+16,7+16,3+16],
    [3+16,7+16,4+16,0+16],
    [8+16,9+16,10+16,11+16],
    [4+16,8+16,9+16,5+16],
    [5+16,9+16,10+16,6+16],
    [6+16,10+16,11+16,7+16],
    [7+16,11+16,8+16,4+16],
    [12+16,13+16,14+16,15+16],
    [8+16,12+16,13+16,9+16],
    [9+16,13+16,14+16,10+16],
    [10+16,14+16,15+16,11+16],
    [11+16,15+16,12+16,8+16],
    ])
mesh = build(mesh_info)
print "Mesh Points:"
for i, p in enumerate(mesh.points):
    print i, p
print "Point numbers in tetrahedra:"
for i, t in enumerate(mesh.elements):
    print i, t
mesh.write_vtk("test.vtk")
